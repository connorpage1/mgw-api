{% extends "admin/base.html" %}

{% block page_title %}Create New Token{% endblock %}
{% block header_title %}Create New API Token{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto bg-white rounded-lg shadow-md p-8">
    
    <!-- Header -->
    <div class="flex justify-between items-center mb-6">
        <h2 class="text-2xl font-bold">Create New API Token</h2>
        <div class="flex gap-3">
            <a href="{{ url_for('admin.tokens') }}" class="text-gray-600 hover:text-gray-900">
                ‚Üê Back to Tokens
            </a>
        </div>
    </div>

    <!-- App Info -->
    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
        <h3 class="text-lg font-semibold text-blue-800 mb-2">Application: {{ app.name }}</h3>
        {% if app.description %}
        <p class="text-sm text-blue-700">{{ app.description }}</p>
        {% endif %}
        <p class="text-xs text-blue-600 mt-2">
            Current active tokens: <strong>{{ app.tokens.filter_by(active=True).count() }}</strong>
        </p>
    </div>

    <!-- Form -->
    <form method="POST" class="space-y-6">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        
        <!-- Token Name -->
        <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                Token Name *
            </label>
            <input type="text" 
                   id="name" 
                   name="name" 
                   required 
                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                   placeholder="e.g., Production API Key, Development Token, Analytics Access">
            <p class="text-xs text-gray-500 mt-1">
                A descriptive name to help identify this token's purpose. Must be unique within this app.
            </p>
        </div>

        <!-- Security Notice -->
        <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
            <h3 class="text-sm font-semibold text-yellow-800 mb-2">üîê Security Notice</h3>
            <ul class="text-xs text-yellow-700 space-y-1">
                <li>‚Ä¢ The token will be shown only once after creation</li>
                <li>‚Ä¢ Store it securely - we cannot recover it if lost</li>
                <li>‚Ä¢ Tokens provide full API access for this application</li>
                <li>‚Ä¢ You can revoke or delete tokens at any time</li>
            </ul>
        </div>

        <!-- Token Usage Guidelines -->
        <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
            <h3 class="text-sm font-semibold text-gray-800 mb-2">üí° Usage Guidelines</h3>
            <div class="text-xs text-gray-700 space-y-1">
                <p><strong>Production tokens:</strong> Use descriptive names like "Production API Key"</p>
                <p><strong>Development tokens:</strong> Use names like "Dev Environment" or "Staging Access"</p>
                <p><strong>Service-specific:</strong> Use names like "Analytics Service" or "Mobile App"</p>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="flex justify-end gap-3 pt-6 border-t">
            <a href="{{ url_for('admin.tokens') }}" 
               class="px-4 py-2 text-gray-600 hover:text-gray-900 border border-gray-300 rounded-md">
                Cancel
            </a>
            <button type="submit" 
                    class="px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md font-semibold">
                üîë Generate Token
            </button>
        </div>
    </form>

    <!-- How to Use Tokens -->
    <div class="mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6">
        <h3 class="text-lg font-semibold text-blue-800 mb-3">üìö How to Use API Tokens</h3>
        <div class="text-sm text-blue-700 space-y-2">
            <p><strong>Include the token in your API requests using one of these methods:</strong></p>
            <ul class="ml-4 space-y-1">
                <li>‚Ä¢ Authorization header: <code class="bg-white px-1 rounded">Authorization: Bearer your_token_here</code></li>
                <li>‚Ä¢ X-API-Key header: <code class="bg-white px-1 rounded">X-API-Key: your_token_here</code></li>
                <li>‚Ä¢ Query parameter: <code class="bg-white px-1 rounded">?api_key=your_token_here</code></li>
            </ul>
        </div>
    </div>

</div>
{% endblock %}