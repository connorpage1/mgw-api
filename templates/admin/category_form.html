{% extends "admin/base.html" %}

{% block page_title %}{{ category and 'Edit' or 'New' }} Category{% endblock %}
{% block header_title %}{{ category and 'Edit' or 'New' }} Category{% endblock %}

{% block content %}
<div class="max-w-xl mx-auto bg-white rounded-lg shadow-md p-8">
    <h2 class="text-2xl font-bold mb-6">{{ category and 'Edit' or 'Create New' }} Category</h2>
    <form method="post" class="space-y-6">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        
        <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">Name <span class="text-red-500">*</span></label>
            <input type="text" id="name" name="name" required
                   value="{{ (form_data and form_data.name) or (category and category.name) or '' }}"
                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 bg-gray-50"
                   placeholder="Enter category name">
        </div>
        
        <div>
            <label for="description" class="block text-sm font-medium text-gray-700 mb-2">Description</label>
            <textarea id="description" name="description" rows="3"
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 bg-gray-50"
                      placeholder="Optional description for this category">{{ (form_data and form_data.description) or (category and category.description) or '' }}</textarea>
        </div>
        
        <div>
            <label for="sort_order" class="block text-sm font-medium text-gray-700 mb-2">Sort Order</label>
            <input type="number" id="sort_order" name="sort_order" min="0"
                   value="{{ (form_data and form_data.sort_order) or (category and category.sort_order) or '0' }}"
                   class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 bg-gray-50"
                   placeholder="Order for displaying categories">
            <p class="text-sm text-gray-500 mt-1">Lower numbers appear first in lists</p>
        </div>
        
        <div>
            <label class="flex items-center">
                <input type="hidden" name="is_active" value="0">
                <input type="checkbox" name="is_active" value="1"
                       class="mr-2 rounded border-gray-300 focus:ring-2 focus:ring-purple-500"
                       {% if (form_data and form_data.is_active) or (category and category.is_active) or (form_data is not defined and category is not defined) %}checked{% endif %}>
                <span class="text-sm text-gray-700">Active Category</span>
            </label>
            <p class="text-sm text-gray-500 mt-1">Inactive categories are hidden from public view</p>
        </div>
        <div class="flex justify-end space-x-4">
            <a href="{{ url_for('admin.glossary_categories') }}"
               class="px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50">
                Cancel
            </a>
            <button type="submit" class="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-6 py-2 rounded-lg hover:from-green-700 hover:to-emerald-700">
                {{ category and 'Update' or 'Create' }} Category
            </button>
        </div>
    </form>
    {% if category %}
    <form method="post" action="{{ url_for('admin.delete_category', category_id=category.id) }}" class="mt-6" 
          data-confirm='{"title": "Delete Category", "message": "Are you sure you want to delete this category? This action cannot be undone.", "action": "Delete"}'>
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
        <input type="hidden" name="delete" value="1">
        <button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded">Delete Category</button>
    </form>
    {% endif %}
</div>
{% endblock %}
